(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();let c=localStorage.getItem("favorites")?JSON.parse(localStorage.getItem("favorites")):[];const m=document.getElementById("movie-section"),v=t=>{const e=document.createElement("div"),s=document.createElement("span"),r=document.createElement("img");s.classList.add("heart"),s.classList.add("heart-blue"),r.src=`${t.image.medium}`,e.classList.add("box"),e.setAttribute("id",t.id),e.appendChild(r),e.appendChild(s),m.appendChild(e)},y=()=>{document.querySelectorAll(".heart").forEach(e=>{e.addEventListener("click",s=>{s.target.classList.toggle("heart-red"),s.target.classList.toggle("heart-blue"),s.target.classList.contains("heart-red")?(c.push(e.parentNode.id),localStorage.setItem("favorites",JSON.stringify(c))):(c=c.filter(r=>r!==e.parentNode.id),localStorage.setItem("favorites",JSON.stringify(c)))})})},S=()=>{document.querySelectorAll(".box").forEach(e=>{c.includes(e.id)&&e.lastChild.classList.add("heart-red")})},u=t=>{m.textContent="",t.forEach(e=>{v(e),S()}),y()},E=document.getElementById("sort-button"),a=document.getElementById("search-box"),f=document.getElementById("filter-button"),l=document.getElementById("filter-type"),d=(t,e)=>{const s=JSON.parse(localStorage.getItem("favorites"));switch(e){case"All":return t;case"Favorites":return t.filter(r=>s.includes(r.id.toString()));default:return t.filter(r=>r.genres.includes(e))}},L=()=>{const e=JSON.parse(localStorage.getItem("movies")).sort((s,r)=>s.name.localeCompare(r.name));u(e)},g=async()=>{const s=(await(await fetch("https://api.tvmaze.com/shows")).json()).sort((r,o)=>o.weight-r.weight);return localStorage.setItem("movies",JSON.stringify(s)),s},w=async()=>{const t=a.value.trim().toLowerCase().replace(/ /g,"+");if(t){const n=(await(await fetch(`https://api.tvmaze.com/search/shows?q=${t}`)).json()).map(p=>p.show),i=d(n,l.value);return localStorage.setItem("movies",JSON.stringify(i)),i}const e=await g(),s=d(e,l.value);return localStorage.setItem("movies",JSON.stringify(s)),s},h=async t=>{const e=await t();u(e)};h(g);E.addEventListener("click",L);f.addEventListener("click",()=>{h(w),a.value=""});a.addEventListener("keypress",t=>{t.key==="Enter"&&f.click()});
